{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section class="bg-gradient-to-b from-blue-50 to-slate-50 py-16 md:py-24">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <!-- Title -->
        <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-4">
            –ù–∞–π–¥–∏—Ç–µ –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ
        </h2>
        <p class="text-lg text-slate-600 mb-8 max-w-2xl mx-auto">
            –ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≥–æ—Ä–æ–¥–∞ –í–æ–ª–æ–≥–¥—ã. 
            –£–∑–Ω–∞–π—Ç–µ, –≤ –∫–∞–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –µ—Å—Ç—å –Ω—É–∂–Ω–∞—è –∫–Ω–∏–≥–∞.
        </p>
        
        <!-- Search Form -->
        <div class="max-w-2xl mx-auto relative">
            <form action="/search" method="get" class="relative">
                <div class="relative">
                    <!-- Search Icon -->
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                        <i data-lucide="search" class="w-5 h-5 text-slate-400"></i>
                    </div>
                    
                    <!-- Search Input -->
                    <input 
                        type="text" 
                        name="q" 
                        id="search-input"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ –∏–ª–∏ –∞–≤—Ç–æ—Ä–∞..."
                        class="search-input w-full pl-12 pr-24 py-4 text-lg bg-white border border-slate-300 rounded-xl focus:outline-none focus:border-blue-500 transition"
                        autocomplete="off"
                        oninput="showSuggestions(this.value)"
                    >
                    
                    <!-- Search Button -->
                    <button 
                        type="submit" 
                        class="absolute inset-y-2 right-2 px-3 sm:px-6 bg-blue-700 hover:bg-blue-800 text-white font-medium rounded-lg transition flex items-center space-x-1 sm:space-x-2"
                    >
                        <span class="hidden sm:inline">–ù–∞–π—Ç–∏</span>
                        <i data-lucide="search" class="w-4 h-4 sm:hidden"></i>
                        <i data-lucide="arrow-right" class="w-4 h-4 hidden sm:block"></i>
                    </button>
                </div>
                
                <!-- Suggestions Dropdown -->
                <div 
                    id="suggestions" 
                    class="absolute z-10 w-full mt-2 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden hidden"
                >
                    <!-- Populated by JavaScript -->
                </div>
            </form>
        </div>
        
        <!-- Popular Searches -->
        <div class="mt-6">
            <p class="text-sm text-slate-500 mb-3">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:</p>
            <div class="flex flex-wrap justify-center gap-2">
                <a href="/search?q=–¢–æ–ª—Å—Ç–æ–π" class="px-3 py-1 bg-white border border-slate-200 rounded-full text-sm text-slate-600 hover:border-blue-500 hover:text-blue-700 transition">
                    –¢–æ–ª—Å—Ç–æ–π
                </a>
                <a href="/search?q=–ü—É—à–∫–∏–Ω" class="px-3 py-1 bg-white border border-slate-200 rounded-full text-sm text-slate-600 hover:border-blue-500 hover:text-blue-700 transition">
                    –ü—É—à–∫–∏–Ω
                </a>
                <a href="/search?q=–î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π" class="px-3 py-1 bg-white border border-slate-200 rounded-full text-sm text-slate-600 hover:border-blue-500 hover:text-blue-700 transition">
                    –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π
                </a>
                <a href="/search?q=–í–æ–π–Ω–∞+–∏+–º–∏—Ä" class="px-3 py-1 bg-white border border-slate-200 rounded-full text-sm text-slate-600 hover:border-blue-500 hover:text-blue-700 transition">
                    –í–æ–π–Ω–∞ –∏ –º–∏—Ä
                </a>
                <a href="/search?q=–ú–∞—Å—Ç–µ—Ä+–∏+–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞" class="px-3 py-1 bg-white border border-slate-200 rounded-full text-sm text-slate-600 hover:border-blue-500 hover:text-blue-700 transition">
                    –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Stats Section -->
<section class="py-12 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
            <div class="p-6">
                <div class="inline-flex items-center justify-center w-12 h-12 bg-blue-100 rounded-xl mb-4">
                    <i data-lucide="book" class="w-6 h-6 text-blue-700"></i>
                </div>
                <h3 class="text-2xl font-bold text-slate-900">20+</h3>
                <p class="text-slate-600">—Ç—ã—Å—è—á –∫–Ω–∏–≥ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</p>
            </div>
            <div class="p-6">
                <div class="inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-xl mb-4">
                    <i data-lucide="building-2" class="w-6 h-6 text-green-700"></i>
                </div>
                <h3 class="text-2xl font-bold text-slate-900">11</h3>
                <p class="text-slate-600">—Ñ–∏–ª–∏–∞–ª–æ–≤ –≤ –≥–æ—Ä–æ–¥–µ</p>
            </div>
            <div class="p-6">
                <div class="inline-flex items-center justify-center w-12 h-12 bg-purple-100 rounded-xl mb-4">
                    <i data-lucide="users" class="w-6 h-6 text-purple-700"></i>
                </div>
                <h3 class="text-2xl font-bold text-slate-900">50+</h3>
                <p class="text-slate-600">—Ç—ã—Å—è—á —á–∏—Ç–∞—Ç–µ–ª–µ–π</p>
            </div>
        </div>
    </div>
</section>

<!-- Libraries Section -->
<section class="py-12 bg-slate-50">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-2xl font-bold text-slate-900 text-center mb-8">–ù–∞—à–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Library Cards -->
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition">
                <div class="flex items-start justify-between mb-4">
                    <div class="bg-blue-100 p-3 rounded-lg">
                        <i data-lucide="library" class="w-6 h-6 text-blue-700"></i>
                    </div>
                    <span class="px-2 py-1 bg-blue-50 text-blue-700 text-xs font-medium rounded">–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è</span>
                </div>
                <h3 class="font-semibold text-slate-900 mb-2">–¶–µ–Ω—Ç—Ä –ø–∏—Å–∞—Ç–µ–ª—è –í.–ò. –ë–µ–ª–æ–≤–∞</h3>
                <p class="text-sm text-slate-600 mb-3">—É–ª. –ü—É—à–∫–∏–Ω—Å–∫–∞—è, 2</p>
                <p class="text-sm text-slate-500">–ü–Ω-–ü—Ç: 10:00-19:00</p>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition">
                <div class="flex items-start justify-between mb-4">
                    <div class="bg-green-100 p-3 rounded-lg">
                        <i data-lucide="library" class="w-6 h-6 text-green-700"></i>
                    </div>
                </div>
                <h3 class="font-semibold text-slate-900 mb-2">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞ –ü–∞–Ω–∫—Ä–∞—Ç–æ–≤–∞</h3>
                <p class="text-sm text-slate-600 mb-3">—É–ª. –ü–∞–Ω–∫—Ä–∞—Ç–æ–≤–∞, 35</p>
                <p class="text-sm text-slate-500">–ü–Ω-–ü—Ç: 11:00-19:00</p>
            </div>
            
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition">
                <div class="flex items-start justify-between mb-4">
                    <div class="bg-purple-100 p-3 rounded-lg">
                        <i data-lucide="library" class="w-6 h-6 text-purple-700"></i>
                    </div>
                </div>
                <h3 class="font-semibold text-slate-900 mb-2">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞ –î–æ–±—Ä–æ–ª—é–±–æ–≤–∞</h3>
                <p class="text-sm text-slate-600 mb-3">—É–ª. –î–æ–±—Ä–æ–ª—é–±–æ–≤–∞, 23</p>
                <p class="text-sm text-slate-500">–ü–Ω-–ü—Ç: 11:00-19:00</p>
            </div>
        </div>
        
        <div class="text-center mt-8">
            <a href="/libraries" class="inline-flex items-center space-x-2 text-blue-700 hover:text-blue-800 font-medium">
                <span>–í—Å–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏</span>
                <i data-lucide="arrow-right" class="w-4 h-4"></i>
            </a>
        </div>
    </div>
</section>

<!-- How It Works -->
<section class="py-12 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-2xl font-bold text-slate-900 text-center mb-8">–ö–∞–∫ –Ω–∞–π—Ç–∏ –∫–Ω–∏–≥—É</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
                    <span class="text-2xl font-bold text-blue-700">1</span>
                </div>
                <h3 class="font-semibold text-slate-900 mb-2">–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å</h3>
                <p class="text-sm text-slate-600">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏, –∞–≤—Ç–æ—Ä–∞ –∏–ª–∏ ISBN</p>
            </div>
            
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
                    <span class="text-2xl font-bold text-blue-700">2</span>
                </div>
                <h3 class="font-semibold text-slate-900 mb-2">–í—ã–±–µ—Ä–∏—Ç–µ –∫–Ω–∏–≥—É</h3>
                <p class="text-sm text-slate-600">–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</p>
            </div>
            
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
                    <span class="text-2xl font-bold text-blue-700">3</span>
                </div>
                <h3 class="font-semibold text-slate-900 mb-2">–ó–∞–±–µ—Ä–∏—Ç–µ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ</h3>
                <p class="text-sm text-slate-600">–£–∑–Ω–∞–π—Ç–µ, –≥–¥–µ –µ—Å—Ç—å –∫–Ω–∏–≥–∞ –≤ –Ω–∞–ª–∏—á–∏–∏</p>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
    /* Mobile optimizations for index */
    @media (max-width: 640px) {
        /* Hero section padding */
        .bg-gradient-to-b { padding-top: 2rem !important; padding-bottom: 2rem !important; }
        
        /* Search input adjustments */
        #search-input { font-size: 16px; padding: 0.75rem 3rem 0.75rem 2.5rem; }
        
        /* Popular searches wrap better */
        .flex-wrap { gap: 0.5rem; }
        .flex-wrap a { font-size: 0.875rem; padding: 0.375rem 0.75rem; }
        
        /* Stats section */
        .grid.grid-cols-1 { gap: 1rem; }
        .grid.grid-cols-1 > div { padding: 1rem; }
        
        /* Library cards */
        .grid.grid-cols-1.md\\:grid-cols-2 { gap: 1rem; }
    }
    
    /* Ensure suggestions don't overflow on mobile */
    #suggestions {
        max-width: calc(100vw - 2rem);
        left: 0;
        right: 0;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
// Search suggestions
let suggestionTimeout;
async function showSuggestions(query) {
    clearTimeout(suggestionTimeout);
    const suggestionsDiv = document.getElementById('suggestions');
    
    if (!query || query.length < 2) {
        suggestionsDiv.classList.add('hidden');
        return;
    }
    
    suggestionTimeout = setTimeout(async () => {
        try {
            const response = await fetch(`/api/v1/search/suggestions?q=${encodeURIComponent(query)}&limit=5`);
            const data = await response.json();
            
            if (data.suggestions && data.suggestions.length > 0) {
                suggestionsDiv.innerHTML = data.suggestions.map(s => {
                    const text = s.replace(/^[üìö‚úçÔ∏è] /, '');
                    const icon = s.startsWith('üìö') ? 'üìö' : '‚úçÔ∏è';
                    return `
                        <div class="px-4 py-3 hover:bg-slate-50 cursor-pointer flex items-center gap-3 border-b border-slate-100 last:border-0" 
                             onclick="selectSuggestion('${escapeHtml(text)}')">
                            <span class="text-2xl">${icon}</span>
                            <span class="text-slate-700 text-lg">${escapeHtml(text)}</span>
                        </div>
                    `;
                }).join('');
                suggestionsDiv.classList.remove('hidden');
            } else {
                suggestionsDiv.classList.add('hidden');
            }
        } catch (error) {
            console.error('Suggestions error:', error);
        }
    }, 200);
}

function selectSuggestion(text) {
    document.getElementById('search-input').value = text;
    document.getElementById('suggestions').classList.add('hidden');
    // Submit form
    document.getElementById('search-input').form.submit();
}

// Hide suggestions when clicking outside
document.addEventListener('click', function(e) {
    const suggestionsDiv = document.getElementById('suggestions');
    const searchInput = document.getElementById('search-input');
    if (!searchInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
        suggestionsDiv.classList.add('hidden');
    }
});

function escapeHtml(text) {
    if (!text) return '';
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}
</script>
{% endblock %}
